<div class="container py-4">
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><%= link_to "Home", root_path %></li>
      <li class="breadcrumb-item"><%= link_to "Cart", cart_path %></li>
      <li class="breadcrumb-item active">Checkout</li>
    </ol>
  </nav>

  <h2>Checkout</h2>

  <div class="row">
    <div class="col-md-8">
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">Complete Your Order</h5>
        </div>
        <div class="card-body">
          <%= form_with model: @order, local: true, data: { turbo: false } do |f| %>
            <!-- Customer Information -->
            <div class="mb-4">
              <h6 class="text-primary">
                <svg width="20" height="20" fill="currentColor" class="me-2" viewBox="0 0 16 16">
                  <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/>
                </svg>
                Customer Information
              </h6>
              <div class="row">
                <div class="col-md-6">
                  <label class="form-label">Name</label>
                  <input type="text" class="form-control" value="<%= current_user.name %>" readonly>
                </div>
                <div class="col-md-6">
                  <label class="form-label">Email</label>
                  <input type="email" class="form-control" value="<%= current_user.email %>" readonly>
                </div>
              </div>
            </div>

            <!-- Shipping Address -->
            <div class="mb-4">
              <h6 class="text-primary">
                <svg width="20" height="20" fill="currentColor" class="me-2" viewBox="0 0 16 16">
                  <path d="m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"/>
                </svg>
                Shipping Address
              </h6>
              <% if current_user.address_line_1.present? %>
                <div class="alert alert-success">
                  <strong>Shipping to:</strong><br>
                  <%= current_user.full_address %>
                </div>
              <% else %>
                <div class="alert alert-warning">
                  <strong>No shipping address on file.</strong>
                </div>
              <% end %>
            </div>

            <!-- Payment Information -->
            <div class="mb-4">
              <h6 class="text-primary">
                <svg width="20" height="20" fill="currentColor" class="me-2" viewBox="0 0 16 16">
                  <path d="M11 5.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-1z"/>
                  <path d="M2 2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H2zm13 2v5H1V4a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1zm-1 9H2a1 1 0 0 1-1-1v-1h14v1a1 1 0 0 1-1 1z"/>
                </svg>
                Payment Information
              </h6>


              <!-- Demo Payment Form -->
              <div class="card bg-light">
                <div class="card-body">
                  <div class="row">
                    <div class="col-md-8">
                      <label class="form-label">Card Number</label>
                      <input type="text" class="form-control" placeholder="4111 1111 1111 1111" readonly>
                    </div>
                    <div class="col-md-4">
                      <label class="form-label">CVV</label>
                      <input type="text" class="form-control" placeholder="123" readonly>
                    </div>
                  </div>
                  <div class="row mt-3">
                    <div class="col-md-6">
                      <label class="form-label">Expiry Month</label>
                      <select class="form-select" disabled>
                        <option>12</option>
                      </select>
                    </div>
                    <div class="col-md-6">
                      <label class="form-label">Expiry Year</label>
                      <select class="form-select" disabled>
                        <option>2025</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Terms and Conditions -->
            <div class="mb-4">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="terms" required>
                <label class="form-check-label" for="terms">
                  I agree to the <a href="#" target="_blank">Terms and Conditions</a> and <a href="#" target="_blank">Privacy Policy</a>
                </label>
              </div>
            </div>

            <div class="d-flex justify-content-between">
              <%= link_to "Back to Cart", cart_path, class: "btn btn-outline-secondary btn-lg" %>
              <%= f.submit "Complete Order", class: "btn btn-success btn-lg px-5" %>
            </div>
          <% end %>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <!-- Order Summary -->
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">Order Summary</h5>
        </div>
        <div class="card-body">
          <% @cart_items.each do |item| %>
            <div class="d-flex justify-content-between mb-2 pb-2 border-bottom">
              <div>
                <div class="fw-bold"><%= item[:product].name %></div>
                <small class="text-muted">Qty: <%= item[:quantity] %> Ã— $<%= item[:product].current_price %></small>
              </div>
              <span class="fw-bold">$<%= item[:subtotal] %></span>
            </div>
          <% end %>

          <div class="mt-3">
            <div class="d-flex justify-content-between mb-2">
              <span>Subtotal:</span>
              <span>$<%= @subtotal %></span>
            </div>
            <div class="d-flex justify-content-between mb-2">
              <span>Tax (13%):</span>
              <span>$<%= @tax %></span>
            </div>
            <div class="d-flex justify-content-between mb-2">
              <span>Shipping:</span>
              <span class="text-success">Free</span>
            </div>
            <hr>
            <div class="d-flex justify-content-between">
              <strong class="fs-5">Total:</strong>
              <strong class="text-primary fs-5">$<%= @total %></strong>
            </div>
          </div>
        </div>
      </div>

      <!-- Security Info -->
      <div class="card mt-3">
        <div class="card-body text-center">
          <div class="text-success mb-2">
            <svg width="32" height="32" fill="currentColor" viewBox="0 0 16 16">
              <path d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"/>
            </svg>
          </div>
          <small class="text-muted">Your information is secure and encrypted</small>
        </div>
      </div>
    </div>
  </div>
</div>